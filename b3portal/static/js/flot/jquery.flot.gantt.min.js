(function(a){function k(b){function r(a,b){function c(a){var c="rgba(255, 255, 255, "+a.series.gantt.highlight.opacity+")";m(b,a.series,a.point,c,true)}b.save();b.clearRect(0,0,e.width,e.height);for(i=0;i<h.length;++i){c(h[i])}b.restore()}function q(a,b,d){var e,g;f=a.getAxes();for(var h=0;h<c.length;h++){e=c[h];if(e.gantt.show){for(var i=0;i<e.data.length;i++){var j=e.data[i];var k=f.xaxis.p2c(j[0]),l=f.xaxis.p2c(j[2]),m=Math.abs(f.yaxis.p2c(j[1])-d);if(m<=e.gantt.barheight/2){if(b>=k&&b<=l){g={i:h,j:i}}}}}}return g}function p(a,b){var c=null;var d=a.getOptions();var e=new HighLighting(a,b,q,d.series.gantt.active,h)}function o(a,b,c,d,e,f){a.beginPath();a.lineWidth=e;a.strokeStyle=f;a.moveTo(b,c);a.lineTo(b,d);a.stroke()}function n(a,b){for(var c=0;c<b.data.length;c++){for(var d=0;d<b.data.length;d++){if(b.data[c][2]==b.data[d][0]){var e=g.left+f.xaxis.p2c(b.data[c][2]),h=g.top+f.yaxis.p2c(b.data[c][1]),i=g.top+f.yaxis.p2c(b.data[d][1]);o(a,e,h,i,b.gantt.connectSteps.lineWidth,b.gantt.connectSteps.color)}}}}function m(a,b,c,d,e){var h,i,k;h=g.left+f.xaxis.p2c(c[0]);i=g.top+f.yaxis.p2c(c[1]);k=g.left+f.xaxis.p2c(c[2]);if(c.length==4){j(a,b,c,h,i,k,d,e)}else{b.gantt.drawstep(a,b,c,h,i,k,d,e)}}function l(b,h){var i;d=b.getCanvas();e=a(d).parent();f=b.getAxes();g=b.getPlotOffset();c=b.getData();for(var j=0;j<c.length;j++){i=c[j];i.gantt.barheight=f.yaxis.p2c(1)/(f.yaxis.max-f.yaxis.min)*i.gantt.barHeight;if(i.gantt.show){for(var k=0;k<i.data.length;k++){m(h,i,i.data[k],i.color,false)}if(i.gantt.connectSteps.show){n(h,i)}}}}function k(a,b){if(b.series.gantt.active){a.hooks.draw.push(l);a.hooks.bindEvents.push(p);a.hooks.drawOverlay.push(r)}}b.hooks.processOptions.push(k)}function j(a,b,c,d,e,f,g,h){if(h==false){a.beginPath();a.lineWidth=b.gantt.barheight;a.strokeStyle="rgb(0,0,0)";a.moveTo(d,e);a.lineTo(f,e);a.stroke()}a.beginPath();a.strokeStyle=g;a.lineWidth=b.gantt.barheight-2;a.lineCap="butt";a.moveTo(d+1,e);a.lineTo(f-1,e);a.stroke()}var b={series:{gantt:{active:false,show:false,connectSteps:{show:false,lineWidth:2,color:"rgb(0,0,0)"},barHeight:.6,highlight:{opacity:.5},drawstep:j}}};var c=null,d=null,e=null,f=null,g=null,h=[];a.plot.plugins.push({init:k,options:b,name:"gantt",version:"0.1"})})(jQuery)
